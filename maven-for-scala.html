<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/xdoc/maven-for-scala.xml.vm at 2024-05-18 10:42

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <meta name="author" content="David Bernard" />
    <title>scala-maven-plugin &#x2013; maven for scala</title>
    <link rel="stylesheet" href="./css/maven-base.css" />
    <link rel="stylesheet" href="./css/maven-theme.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<a href="./" id="bannerLeft">scala-maven-plugin
</a><a href="http://www.scala-lang.org/" id="bannerRight"><img src="images/logos/scala.svg"  alt="Scala-lang" width="30" height="49"/></a>      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2024-05-18 10:42</span>
           | <span id="projectVersion">Version: 4.9.2-SNAPSHOT</span>
      </div>
      <div class="xright"><a href="wiki" title="Wiki">Wiki</a> |
<a href="wiki/frequently-asked-questions" title="FAQ">FAQ</a> |
<a href="http://groups.google.com/group/maven-and-scala" class="externalLink" title="Mailing-list">Mailing-list</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Overview</h5>
    <ul>
     <li class="none"><a href="index.html" title="Introduction">Introduction</a></li>
     <li class="none"><a href="plugin-info.html" title="Goals">Goals</a></li>
     <li class="none"><a href="usage.html" title="Usage">Usage</a></li>
     <li class="none"><a href="faq.html" title="FAQ">FAQ</a></li>
    </ul>
       <h5>Examples</h5>
    <ul>
     <li class="none"><a href="example_compile.html" title="Compiling">Compiling</a></li>
     <li class="none"><a href="example_incremental.html" title="Incremental Compile">Incremental Compile</a></li>
     <li class="none"><a href="example_cc.html" title="Continuous Compilation">Continuous Compilation</a></li>
     <li class="none"><a href="example_cctest.html" title="Continuous Testing">Continuous Testing</a></li>
     <li class="none"><a href="example_doc.html" title="Scaladoc">Scaladoc</a></li>
     <li class="none"><a href="example_run.html" title="Running">Running</a></li>
     <li class="none"><a href="example_script.html" title="Scripting">Scripting</a></li>
     <li class="none"><a href="example_console.html" title="Scala Console">Scala Console</a></li>
     <li class="none"><a href="example_java.html" title="Mixed Java/Scala Projects">Mixed Java/Scala Projects</a></li>
     <li class="none"><a href="example_scalac_plugins.html" title="Creating Scalac Plugins">Creating Scalac Plugins</a></li>
     <li class="none"><a href="articles.html" title="Articles...">Articles...</a></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="project-info.html" title="Project Information">Project Information</a></li>
    </ul>
      <a href="http://maven.apache.org" title="Build with Maven" class="poweredBy">
        <img class="poweredBy"  alt="Build with Maven" src="http://maven.apache.org/images/logos/maven-feather.png"     />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">

	
		<h1>maven for scala</h1>
		
<p>Friday, January 4, 2008</p>        

		<address>Posted by David Bernard</address>
		
<p>I'll try to provide a mini-guide about <a class="externalLink" href="http://maven.apache.org/">maven</a> for scala's project. For more info, go to <a class="externalLink" href="http://maven.apache.org/">maven home</a> or plugin's home.</p>
		<section>
<h2><a name="Introduction_to_maven"></a>Introduction to maven</h2>
			
<p><a class="externalLink" href="http://maven.apache.org/">Maven</a> is a builder like make or ant, written in java.  It's a commande line tool, IDE (Eclipse, Netbeans, IDEA) have plugins to handle and integrate project powered by maven. It could be used to create lib (jar), webapps (ear) and any other type of &quot;artifact&quot;. It prefers convention over configuration, and configuration over instruction. What that mean exactly ?</p>
			
			
<ul>
			
<li>every action have a default configuration (= the convention).</li>
			
<li>every action is a goal defined into a plugin  (aka mojo), and for common case, you will try to use existing plugin instead of calling (more) low level instruction (like copy file,...)</li>
			</ul>
			
<p>Before creating your first scala project, You need to know some info:</p>
			
<ul>
			
<li><a class="externalLink" href="http://maven.apache.org/run-maven/index.html">a command line tool</a>
			
<ul>
			
<li>&quot;mvn&quot; is the name of the command line tool to call maven 2.x. To display help, run <code>mvn help</code></li>
			</ul></li>
			
<li><a class="externalLink" href="http://maven.apache.org/pom.html">the project descriptor</a> : the file [prj]/pom.xml
			
<ul>
			
<li>It's the file when every project information are stored (name, version, dependencies, license, mailing-list,...)</li>
			</ul></li>
			
<li><a class="externalLink" href="http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">the build lifecycle</a> :
			The build lifecycle is defined by a sequence of phases, the main are:
			
<ul>
			
<li>compile - compile the source code of the project</li>
			
<li>test - test the compiled source code using a suitable unit testing framework. These tests should not require the code be packaged or deployed</li>
			
<li>package - take the compiled code and package it in its distributable format, such as a JAR.</li>
			
<li>integration-test - process and deploy the package if necessary into an environment where integration tests can be run</li>
			
<li>install - install the package into the local repository, for use as a dependency in other projects locally</li>
			
<li>deploy - done in an integration or release environment, copies the final package to the remote repository for sharing with other developers and projects.</li>
			</ul>
			A phase is depend of the previous  one, so when you request the phase test, then the phase compile is done before,...</li>
			
<li><a class="externalLink" href="http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html">Directory layout</a>
			
<ul>
			
<li>see below for a scala project</li>
			</ul></li>
			
<li><a class="externalLink" href="http://maven.apache.org/guides/introduction/introduction-to-repositories.html">repository</a>
			
<ul>
			
<li>Maven use repositories (local and remote) to store and to retrieve artifacts and their descriptor (pom). Artifacts are jar, war,... and they could be used as dependencies, maven plugin,...</li>
			
<li>By default, maven search artifact in the central repository. A &quot;dedicated&quot; repository for Scala stuff is available at <a class="externalLink" href="http://scala-tools.org/repo-releases/">http://scala-tools.org/repo-releases/</a>.</li>
			</ul></li>
			</ul>
		</section>
		<section>
<h2><a name="Your_first_scala_project_with_maven"></a>Your first scala project with maven</h2>
			
<p>In the following, we will run maven for the first time. Maven download what it need to work from remote repositories, and cache the downloaded artifact into its local repository (default is <code>$HOME/.m2/repository</code>). It only download what it need for the requested phases/goals (lazy downloading). So the <b>first</b> runs could be very long.</p>

			<section>
<h3><a name="Step_0:_installation"></a>Step 0: installation</h3>
				
<ul>
				
<li>install jdk 1.5+ (eg : on my box <code>$HOME/bin/soft-linux/jdk-1.5.0_03</code>)</li>
				
<li>install maven 2.0.8+ (eg : on my box <code>$HOME/bin/soft-java/apache-maven-2.0.8</code>)
				
<ul>
				
<li>download it</li>
				
<li>unarchive it</li>
				
<li>add the apache-maven-2.0.8/bin directory to your PATH</li>
				
<li>check that maven is in the path: 
				
<ul>
				
<li>go into any directory outside the maven installation</li>
				
<li>run <code>mvn help</code>, you should see
				
				
<div class="source">
<pre>usage: mvn [options] [&lt;goal(s)&gt;] [&lt;phase(s)&gt;]

Options:
-q,--quiet                    Quiet output - only show errors
...
</pre></div></li>
				</ul></li>
				</ul></li>
				</ul>
			</section>
			<section>
<h3><a name="Step_1:_create_a_project"></a>Step 1: create a project</h3>
				
<p>You could create a project skeleton with your favorite file system tools (following directory layout as below) or you could use archetypes. Maven Archetypes are project'skeleton that could be used to create new project.</p>
				
				
<div class="source">
<pre>mvn org.apache.maven.plugins:maven-archetype-plugin:1.0-alpha-7:create \
-DarchetypeGroupId=org.scala-tools.archetypes \
-DarchetypeArtifactId=scala-archetype-simple \
-DarchetypeVersion=1.1 \
-DremoteRepositories=http://scala-tools.org/repo-releases \
-DgroupId=your.proj.gid -DartifactId=your-proj-id</pre></div>
				
<p>At the end of the process you should see something like</p>
				
<div class="source">
<pre>...
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESSFUL
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1 second
[INFO] Finished at: Sat Jan 05 17:39:47 CET 2008
[INFO] Final Memory: 6M/63M
[INFO] ------------------------------------------------------------------------</pre></div>
				
<p>!! Success you now have a empty project under your-proj-id directory with the following directory layout :</p>
				
<div class="source">
<pre>your-proj-id/
|-- pom.xml
`-- src
|-- main
|   `-- scala
|       `-- your
|           `-- proj
|               `-- gid
|                   `-- App.scala
`-- test
    `-- scala
        `-- your
            `-- proj
                `-- gid
                    `-- AppTest.scala</pre></div>
				
<p>In fact, the project is not empty it contains an helloworld application (App.scala) and a JUnit test (AppTest.scala).</p>
				
<p>In the next step, you will request phase (or goals). The results will be put under your-proj-id/target directory. The target directory is the working directory where every plugin put the result of computation. If you want to clean up, request the goal &quot;clean&quot;</p>
				
<div class="source">
<pre>mvn clean</pre></div>
			</section>
			<section>
<h3><a name="Step_2:_compile_the_project"></a>Step 2: compile the project</h3>
				
<div class="source">
<pre># only compile
mvn compile</pre></div>
				
<p>If it's the first time you use maven with scala, the build should failed with a message like</p>
				
<div class="source">
<pre>...
[ERROR] FATAL ERROR
[INFO]
------------------------------------------------------------------------
[INFO] The PluginDescriptor for the plugin Plugin [org.scala-tools:maven-scala-plugin] was not found.
[INFO]
...</pre></div>
				
<dl>
				
<dt>Cause :</dt>
<dd>The pom.xml (autogenerated) doesn't specify wish version to use for maven-scala-plugin, so maven try to use the latest available localy, and none was previously downloaded.</dd>
				
<dt>Solutions :</dt>
<dd>Edit the pom.xml and define a version for the plugin.</dd>
				
<dd>Request to download the latest available on remote repositories.</dd>
				</dl>
				
<p>I prefer the second solution (in this case):</p>
				
<div class="source">
<pre># only compile
mvn -U compile</pre></div>
				
<p>now you should see</p>
				
<div class="source">
<pre>...
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESSFUL
[INFO] ------------------------------------------------------------------------
...</pre></div>
			</section>
			<section>
<h3><a name="Step_3:_compile_and_running_test"></a>Step 3: compile and running test</h3>
				
<p>The skeleton create a JUnit test AppTest.scala as sample, try to compile and run it</p>
				
<div class="source">
<pre># compile + compile test + run test
mvn test</pre></div>
				
<p>you should get :</p>
				
<div class="source">
<pre>...
-------------------------------------------------------
T E S T S
-------------------------------------------------------
Running your.proj.gid.AppTest
Tests run: 2, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 0.054 sec &lt;&lt;&lt; FAILURE!

Results :

Failed tests:
testKO(your.proj.gid.AppTest)

Tests run: 2, Failures: 1, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[ERROR] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] There are test failures.

Please refer to /home/dwayne/tmp/your-proj-id/target/surefire-reports for the individual test results.</pre></div>
				
<p>BUILD FAILURE, it's not good! So read the log on console :</p>
				
<ul>
				
<li>there is 2 tests and one of them failed</li>
				
<li>the failed test is the method testKO from the class your.proj.gid.AppTest</li>
				
<li>see the content of the directory .../your-proj-id/target/surefire-reports for details</li>
				</ul>
				
<p>So you could read the problem in .../your-proj-id/target/surefire-reports/your.proj.gid.AppTest.txt</p>
				
<div class="source">
<pre>...
testKO(your.proj.gid.AppTest)  Time elapsed: 0.01 sec  &lt;&lt;&lt; FAILURE!
junit.framework.AssertionFailedError
    at junit.framework.Assert.fail(Assert.java:47)
    at junit.framework.Assert.assertTrue(Assert.java:20)
    at junit.framework.Assert.assertTrue(Assert.java:27)
    at your.proj.gid.AppTest.testKO(AppTest.scala:26)
    at your.proj.gid.AppTest.testKO(AppTest.scala:26)
...</pre></div>
				
<p>So edit the test and fix it (it's easy), and rerun test until it pass.
Why the empty project is created with a failed test? to check that test are running and are used.</p>
			</section>
			<section>
<h3><a name="Step_4:_generate_the_jar"></a>Step 4: generate the jar</h3>
				
<div class="source">
<pre># compile + run test + generate the jar
mvn package</pre></div>
				
<p>If you fixed the test in Step 3, then a jar should be generated under the target directory. The jar doesn't contains the test classes, only the classes from src/main/scala/...</p>
			</section>
			<section>
<h3><a name="Step_5:_start_coding"></a>Step 5: start coding</h3>
				
<ul>
				
<li>add scala file under src/main/scala/... or src/test/scala/...</li>
				
<li>run the phases or goal you wish,...</li>
				
<li>if you need more lib (dependencies), edit the pom.xml and add &lt;dependecy&gt; node. By default you could declare dependency available on central repo (I suggest to use <a class="externalLink" href="http://mvnrepository.com/">mvnrepository</a> as a search engine in central repo), or in <a class="externalLink" href="http://scala-tools.org/repo-releases/">http://scala-tools.org/repo-releases/</a> (browse the directory, no search engine available :()</li>
				</ul>
			</section>
		</section>
		<section>
<h2><a name="Conclusion"></a>Conclusion</h2>
			
<p>I expect this overlook and quick tutorial could help you to start playing with maven and scala. I  plan to write other articles about &quot;maven for scala&quot; (about, the pom.xml and repositories). If you want to know more about maven and don't want to wai futur article, I suggest you browse the <a class="externalLink" href="http://maven.apache.org/guides/index.html">documentation of maven</a>. I also suggest you to take a look at the <a class="externalLink" href="http://scala-tools.org/mvnsites/maven-scala-plugin/">maven-scala-plugin 2.x documentation</a>, you'll see how to generate scaladoc, choose the scala version, or run a scala console with the project dependencies.</p>
			
<p>If you have question ask, If you want I detail some point here or in a futur article, ask.</p>
		</section>
	

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2012&#x2013;2024..      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
